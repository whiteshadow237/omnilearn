<!DOCTYPE html>
<html lang="fr" data-theme="light" data-version="2.0">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OmniLearn</title>
    
    <!-- Favicons pour tous les navigateurs et appareils -->
    <link rel="icon" href="frontend/images/logo.jpeg" type="image/jpeg">
    <link rel="shortcut icon" href="frontend/images/logo.jpeg" type="image/jpeg">
    <link rel="apple-touch-icon" href="frontend/images/logo.jpeg">
    <link rel="apple-touch-icon" sizes="152x152" href="frontend/images/logo.jpeg">
    <link rel="apple-touch-icon" sizes="180x180" href="frontend/images/logo.jpeg">
    <link rel="apple-touch-icon" sizes="167x167" href="frontend/images/logo.jpeg">
    <!-- Pour IE et Windows 10 -->
    <meta name="msapplication-TileImage" content="frontend/images/logo.jpeg">
    <meta name="msapplication-TileColor" content="#58cc02">
    
    <!-- Manifest pour l'installation de l'application -->
    <link rel="manifest" href="frontend/manifest.json">
    <meta name="theme-color" content="#58cc02">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="OmniLearn">
    
    <!-- Script d'initialisation du thème -->
    <script>
        //script dark theme mode
        console.log("Chargement initial de la page");
    </script>
    
    <!-- Remixicon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- MathJax pour les formules mathématiques -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- KaTeX pour les formules mathématiques -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <!-- Style WhatsApp pour l'écran de chargement -->
    <style>
        /* Style de l'écran de chargement type WhatsApp Web */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f0f2f5;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        html[data-theme="dark"] .splash-screen,
        body.dark-theme .splash-screen {
            background-color: #111b21;
        }
        
        .splash-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 320px;
        }
        
        .splash-logo {
            width: 100px;
            height: 100px;
            margin-bottom: 40px;
            border-radius: 10px;
            background-color: #fff;
            padding: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        html[data-theme="dark"] .splash-logo,
        body.dark-theme .splash-logo {
            background-color: #222e35;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .splash-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .splash-progress-container {
            width: 100%;
            height: 4px;
            background-color: #e1e4e6;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 12px;
        }
        
        html[data-theme="dark"] .splash-progress-container,
        body.dark-theme .splash-progress-container {
            background-color: #2a3942;
        }
        
        .splash-progress-bar {
            height: 100%;
            background-color: #58cc02;
            width: 0%;
            border-radius: 2px;
            transition: width 0.5s ease;
        }
        
        .splash-percentage {
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            color: #41525d;
            margin-bottom: 20px;
        }
        
        html[data-theme="dark"] .splash-percentage,
        body.dark-theme .splash-percentage {
            color: #aebac1;
        }
        
        .splash-text {
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            color: #41525d;
            margin-bottom: 5px;
            text-align: center;
        }
        
        html[data-theme="dark"] .splash-text,
        body.dark-theme .splash-text {
            color: #d1d7db;
        }
        
        .splash-subtext {
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            color: #8696a0;
            text-align: center;
            max-width: 280px;
        }
        
        html[data-theme="dark"] .splash-subtext,
        body.dark-theme .splash-subtext {
            color: #8696a0;
        }
        
        .splash-message {
            margin-top: 30px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            color: #8696a0;
            text-align: center;
            padding: 10px 15px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            width: 100%;
        }
        
        html[data-theme="dark"] .splash-message,
        body.dark-theme .splash-message {
            background-color: rgba(42, 57, 66, 0.7);
        }
    </style>
    
    <!-- Styles -->
    <link rel="stylesheet" href="frontend/styles/style-override.css">
    <link rel="stylesheet" href="frontend/css/styles.css">
    <link rel="stylesheet" href="frontend/css/animations.css">
    <link rel="stylesheet" href="frontend/css/accordion.css">
    <link rel="stylesheet" href="frontend/css/definitions.css">
    <link rel="stylesheet" href="frontend/css/program.css">
    <link rel="stylesheet" href="frontend/css/courses.css">
    <!-- Style spécifique pour l'assistant en mode sombre -->
    <link rel="stylesheet" href="frontend/styles/ai-dark-style.css">
    <!-- Style spécifique pour l'assistant en mode clair -->
    <link rel="stylesheet" href="frontend/styles/ai-light-style.css">
    <!-- Style spécifique pour les formules et tableaux -->
    <link rel="stylesheet" href="frontend/styles/formula-tables-style.css">
    <style>
        /* Ajout de KaTeX pour les formules mathématiques */
        @font-face {
            font-family: 'KaTeX_Math';
            src: url('https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/fonts/KaTeX_Math-Italic.woff2') format('woff2');
            font-weight: normal;
            font-style: italic;
        }

        /* Style spécifique pour les formules mathématiques */
        .math-formula {
            display: block;
            margin: 10px 0;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            font-family: 'KaTeX_Math', 'Times New Roman', serif;
            font-size: 1.3em;
            color: #000000;
            text-align: center;
        }
        
        html[data-theme="dark"] .math-formula,
        body.dark-theme .math-formula {
            background: #3a3a3a;
            color: #ffffff;
        }

        /* Style pour les exemples */
        .example {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        html[data-theme="dark"] .example,
        body.dark-theme .example {
            background: #2f2f2f;
        }

        .example p {
            color: #000000;
            margin: 8px 0;
        }
        
        html[data-theme="dark"] .example p,
        body.dark-theme .example p {
            color: #ffffff;
        }

        /* Style pour les tableaux de formules */
        .formula-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: #ffffff;
        }
        
        html[data-theme="dark"] .formula-table,
        body.dark-theme .formula-table {
            background: #2f2f2f;
        }

        .formula-table th, .formula-table td {
            padding: 12px;
            border: 1px solid #e0e0e0;
            text-align: center;
            color: #000000;
        }
        
        html[data-theme="dark"] .formula-table th,
        html[data-theme="dark"] .formula-table td,
        body.dark-theme .formula-table th,
        body.dark-theme .formula-table td {
            border-color: #3a3a3a;
            color: #ffffff;
        }

        .formula-table th {
            background: #f4f4f4;
            font-weight: 600;
        }
        
        html[data-theme="dark"] .formula-table th,
        body.dark-theme .formula-table th {
            background: #3a3a3a;
        }

        /* Styles pour l'historique */
        .history-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: #f0f0f0;
            cursor: pointer;
        }

        .history-icon i {
            font-size: 20px;
            color: #333;
        }

        .dropdown-header {
            padding: 10px 15px;
            background-color: #f8f9fa;
        }

        .dropdown-header h4 {
            margin: 0;
            font-size: 16px;
            color: #333;
        }

        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            transition: background-color 0.2s;
        }

        .history-item:hover {
            background-color: #f5f5f5;
        }

        .history-details {
            margin-left: 10px;
        }

        .history-title {
            font-weight: 500;
            color: #333;
        }

        .history-meta {
            font-size: 12px;
            color: #666;
        }

        .clear-history {
            color: #dc3545;
        }

        .clear-history:hover {
            background-color: #fff4f4;
        }

        /* Styles pour la page d'accueil */
        .welcome-banner {
            background: linear-gradient(135deg, #3f51b5 0%, #7986cb 100%);
            color: white;
            padding: 40px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .welcome-banner h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-banner p {
            font-size: 1.2rem;
            margin-bottom: 25px;
            opacity: 0.9;
        }

        .banner-buttons {
            margin-top: 20px;
        }

        .btn-lg {
            padding: 12px 24px;
            font-size: 1.1rem;
        }

        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #e8eaf6;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .feature-icon i {
            font-size: 28px;
            color: #3f51b5;
        }

        .feature-card h3 {
            font-size: 1.3rem;
            margin-bottom: 12px;
            color: #333;
        }

        .feature-card p {
            color: #666;
            line-height: 1.6;
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .level-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        .level-card h3 {
            font-size: 1.4rem;
            margin-bottom: 8px;
            color: #333;
        }

        .level-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .level-subjects {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .subject-tag {
            background-color: #e8eaf6;
            color: #3f51b5;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Styles responsifs */
        @media screen and (max-width: 768px) {
            .welcome-banner h1 {
                font-size: 1.8rem;
            }

            .welcome-banner p {
                font-size: 1rem;
            }

            .feature-icon {
                width: 50px;
                height: 50px;
            }

            .feature-icon i {
                font-size: 24px;
            }

            .levels-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Styles pour l'assistant IA */
        #ai-assistant {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            height: 100%;
            transition: all 0.3s ease;
        }

        #ai-assistant.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            max-width: 100%;
            height: 100vh;
            z-index: 9999;
            margin: 0;
            border-radius: 0;
            background-color: #f6f7fb;
        }

        #ai-assistant.fullscreen .ai-assistant-container {
            height: 100vh;
            border-radius: 0;
            margin: 0;
        }

        .ai-assistant-container {
            max-width: 100%;
            margin: 20px auto;
            border-radius: 14px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: hidden;
            background: #fff;
            height: calc(100vh - 100px);
            transition: all 0.3s ease;
        }

        .ai-assistant-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #58cc02;
            color: white;
        }

        .assistant-controls {
            display: flex;
            gap: 10px;
        }

        .assistant-controls button {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .assistant-controls button:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .assistant-controls button i {
            font-size: 20px;
        }

        .fullscreen-assistant.active i {
            content: "\eb99"; /* ri-fullscreen-exit-line */
        }

        .ai-chat-container {
            display: flex;
            flex-direction: column;
            height: calc(100% - 60px);
            background: #f6f7fb;
        }

        .recording-indicator {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: #212121;
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 500;
            display: none;
            align-items: center;
            gap: 15px;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            animation: fadeInDown 0.3s forwards;
            width: 80%;
            max-width: 450px;
        }

        .recording-indicator.active {
            display: flex;
        }

        .recording-timer {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            min-width: 60px;
        }

        .recording-timer i {
            font-size: 1.8rem;
            color: #f44336;
            animation: pulse 1.5s infinite;
        }

        .timer-display {
            font-family: monospace;
            font-size: 1rem;
            font-weight: bold;
        }

        .privacy-indicator {
            font-size: 0.7rem;
            color: #ff6b6b;
            margin-top: 2px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .privacy-indicator::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #ff6b6b;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .recording-message {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .waveform-visualizer {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            height: 20px;
        }

        .waveform-visualizer span {
            display: inline-block;
            width: 3px;
            height: 5px;
            background-color: #ffffff;
            border-radius: 5px;
            animation: waveform-animation 1.2s ease-in-out infinite;
        }

        .waveform-visualizer span:nth-child(1) {
            animation-delay: 0s;
        }

        .waveform-visualizer span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .waveform-visualizer span:nth-child(3) {
            animation-delay: 0.4s;
        }

        .waveform-visualizer span:nth-child(4) {
            animation-delay: 0.6s;
        }

        .waveform-visualizer span:nth-child(5) {
            animation-delay: 0.8s;
        }

        @keyframes waveform-animation {
            0%, 100% {
                height: 5px;
            }
            50% {
                height: 20px;
            }
        }

        .stop-recording {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background-color: #f44336;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .stop-recording:hover {
            background-color: #d32f2f;
        }

        .stop-recording i {
            font-size: 1.3rem;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translate(-50%, -20px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: #f6f7fb;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .ai-message {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .ai-message.user {
            align-items: flex-end;
        }

        .ai-message-bubble {
            padding: 14px 20px;
            border-radius: 18px;
            max-width: 80%;
            font-size: 1.08rem;
            line-height: 1.6;
            margin-bottom: 2px;
            box-shadow: 0 1px 6px rgba(0,0,0,0.06);
            word-break: break-word;
        }

        .ai-message.user .ai-message-bubble {
            background: #dcf8c6;
            color: #222;
            align-self: flex-end;
        }

        .ai-message.assistant .ai-message-bubble {
            background: #fff;
            color: #222;
            align-self: flex-start;
        }

        .ai-typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 20px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #999;
            border-radius: 50%;
            animation: typing-dot 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing-dot {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .ai-chat-input {
            display: flex;
            align-items: flex-end;
            padding: 10px 15px;
            background: white;
            border-top: 1px solid #eee;
        }

        .ai-chat-input textarea {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            margin-right: 10px;
            font-family: inherit;
            font-size: 1rem;
            resize: none;
            max-height: 120px;
            outline: none;
        }

        .input-buttons {
            display: flex;
            gap: 8px;
        }

        .ai-chat-input button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #58cc02;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
        }

        .ai-chat-input button:hover {
            background: #4aad02;
        }

        .voice-input {
            background: #3f51b5 !important;
        }

        .voice-input:hover {
            background: #303f9f !important;
        }

        .voice-input.recording {
            background: #f44336 !important;
            animation: pulse 1.5s infinite;
        }

        .voice-input.recording:hover {
            background: #d32f2f !important;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .error-message {
            margin: 10px auto;
            padding: 10px 15px;
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            color: #d32f2f;
            border-radius: 4px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            max-width: 80%;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .error-message i {
            font-size: 1.2rem;
        }

        .error-message.fade-out {
            opacity: 0;
        }

        .privacy-notice {
            margin: 10px auto;
            padding: 10px 15px;
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            color: #0d47a1;
            border-radius: 4px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
            max-width: 90%;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .privacy-notice i {
            font-size: 1.2rem;
            color: #2196f3;
        }

        .privacy-notice.fade-out {
            opacity: 0;
        }

        /* Amélioration de l'écran de chargement avec pourcentage */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        html[data-theme="dark"] .loading-screen,
        body.dark-theme .loading-screen {
            background-color: #121212;
        }
        
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 80%;
        }
        
        .logo-container {
            margin-bottom: 30px;
            animation: pulse 1.5s infinite;
        }
        
        .logo-container img {
            width: 120px;
            height: 120px;
            border-radius: 20px;
        }
        
        .loading-bar-container {
            width: 300px;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        html[data-theme="dark"] .loading-bar-container,
        body.dark-theme .loading-bar-container {
            background-color: #333333;
        }
        
        .loading-bar {
            height: 100%;
            width: 0%;
            background-color: #58cc02;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .loading-percentage {
            font-family: 'Poppins', sans-serif;
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        html[data-theme="dark"] .loading-percentage,
        body.dark-theme .loading-percentage {
            color: #e0e0e0;
        }
        
        .loading-text {
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            color: #666;
            text-align: center;
        }
        
        html[data-theme="dark"] .loading-text,
        body.dark-theme .loading-text {
            color: #aaaaaa;
        }
        
        .loading-details {
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            color: #888;
            margin-top: 5px;
            text-align: center;
        }
        
        html[data-theme="dark"] .loading-details,
        body.dark-theme .loading-details {
            color: #777777;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Animation pour le texte de chargement */
        .loading-text-animated::after {
            content: '';
            animation: loading-dots 1.5s infinite;
        }

        @keyframes loading-dots {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
            100% { content: '.'; }
        }
    </style>
</head>
<body>
    <!-- Écran de chargement style WhatsApp Web -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-container">
            <div class="splash-logo">
                <img src="frontend/images/logo.jpeg" alt="OmniLearn">
            </div>
            <div class="splash-progress-container">
                <div class="splash-progress-bar" id="splashProgressBar"></div>
            </div>
            <div class="splash-percentage" id="splashPercentage">0%</div>
            <div class="splash-text">OmniLearn est en cours de chargement</div>
            <div class="splash-subtext" id="splashStatus">Initialisation de l'application...</div>
            
            <div class="splash-message">
                KroK AI de xAI est prêt à répondre à toutes vos questions sur les mathématiques, la physique et la chimie.
            </div>
        </div>
    </div>
    
    <!-- Application principale -->
    <div class="app-container" style="visibility: hidden;">
        <!-- Bannière mode hors ligne -->
        <div id="offline-banner" class="offline-banner" style="display: none;">
            <i class="ri-wifi-off-line"></i>
            <span>Mode hors ligne - Toutes les fonctionnalités restent disponibles</span>
            <button class="close-banner"><i class="ri-close-line"></i></button>
        </div>
        
        <!-- En-tête -->
        <header class="app-header">
            <div class="header-left">
                <button class="menu-toggle">
                    <i class="ri-menu-line"></i>
                </button>
                <a href="#home" class="logo-link">
                    <div class="logo">
                        <img src="frontend/images/logo.jpeg" alt="OmniLearn">
                    </div>
                    <h1 class="app-title">OmniLearn</h1>
                </a>
            </div>
            
            <!-- Barre de recherche principale style YouTube -->
            <div class="header-search">
                <div class="search-bar">
                    <i class="ri-search-line"></i>
                    <input type="text" class="search-input" placeholder="Rechercher dans OmniLearn...">
                </div>
            </div>
            
            <div class="header-center">
                <nav class="main-nav">
                    <a href="#home" class="active"><i class="ri-home-line"></i> Accueil</a>
                    <a href="#courses"><i class="ri-book-line"></i> Cours</a>
                    <a href="#program"><i class="ri-graduation-cap-line"></i> Programme</a>
                    <a href="#exercises"><i class="ri-edit-line"></i> Exercices</a>
                    <a href="#definitions"><i class="ri-book-mark-line"></i> Définitions</a>
                    <a href="#tests"><i class="ri-file-list-line"></i> Tests</a>
                    <a href="#ai-assistant"><i class="ri-robot-line"></i> Assistant IA</a>
                    <a href="#formula-book"><i class="ri-book-line"></i> Cahier de Formules</a>
                </nav>
            </div>
            <div class="header-right">
                <div class="theme-switch-container">
                    <label class="theme-switch" title="Changer le thème (clair/sombre)">
                        <input type="checkbox">
                        <span class="theme-slider"></span>
                    </label>
                </div>
                <div class="ai-assistant-btn mobile-only" title="Assistant IA">
                    <a href="#ai-assistant">
                        <i class="ri-robot-line"></i>
                    </a>
                </div>
                <div class="user-menu">
                    <button class="user-toggle">
                        <div class="history-icon">
                            <i class="ri-history-line"></i>
                        </div>
                    </button>
                    <div class="user-dropdown">
                        <div class="dropdown-header">
                            <h4>Historique des cours</h4>
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="history-list">
                            <a href="#" class="dropdown-item history-item">
                                <i class="ri-time-line"></i>
                                <div class="history-details">
                                    <div class="history-title">Systèmes d'équations</div>
                                    <div class="history-meta">Mathématiques - 3ème</div>
                                </div>
                            </a>
                            <a href="#" class="dropdown-item history-item">
                                <i class="ri-time-line"></i>
                                <div class="history-details">
                                    <div class="history-title">Théorème de Thalès</div>
                                    <div class="history-meta">Mathématiques - 3ème</div>
                                </div>
                            </a>
                            <a href="#" class="dropdown-item history-item">
                                <i class="ri-time-line"></i>
                                <div class="history-details">
                                    <div class="history-title">Vecteurs du plan</div>
                                    <div class="history-meta">Mathématiques - 2nde C</div>
                                </div>
                            </a>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item clear-history">
                            <i class="ri-delete-bin-line"></i> Effacer l'historique
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#help" class="dropdown-item">
                            <i class="ri-question-line"></i> Aide
                        </a>
                        <a href="#" class="dropdown-item text-danger logout-btn">
                            <i class="ri-logout-box-line"></i> Déconnexion
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation mobile (visible uniquement sur mobile) -->
        <nav class="mobile-nav">
            <!-- Barre de recherche mobile -->
            <div class="mobile-search-bar">
                <div class="search-bar">
                    <i class="ri-search-line"></i>
                    <input type="text" class="search-input" placeholder="Rechercher...">
                </div>
            </div>
            
            <ul class="mobile-nav__list">
                <li class="mobile-nav__item">
                    <a href="#courses" class="mobile-nav__link active-nav">
                        <i class="ri-book-open-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Cours</span>
                    </a>
                </li>
                <li class="mobile-nav__item">
                    <a href="#program" class="mobile-nav__link">
                        <i class="ri-graduation-cap-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Programme</span>
                    </a>
                </li>
                <li class="mobile-nav__item">
                    <a href="#exercises" class="mobile-nav__link">
                        <i class="ri-edit-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Exercices</span>
                    </a>
                </li>
                <li class="mobile-nav__item">
                    <a href="#definitions" class="mobile-nav__link">
                        <i class="ri-book-mark-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Définitions</span>
                    </a>
                </li>
                <li class="mobile-nav__item">
                    <a href="#tests" class="mobile-nav__link">
                        <i class="ri-file-list-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Tests</span>
                    </a>
                </li>
                <li class="mobile-nav__item">
                    <a href="#formula-book" class="mobile-nav__link">
                        <i class="ri-book-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Formules</span>
                    </a>
                </li>
                <li class="mobile-nav__item">
                    <a href="#profile" class="mobile-nav__link">
                        <i class="ri-user-line mobile-nav__icon"></i>
                        <span class="mobile-nav__name">Profil</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Contenu principal -->
        <main class="app-main">
            <!-- Barre latérale -->
            <aside class="app-sidebar">
                <div class="sidebar-content">
                    <!-- Navigation des matières -->
                    <nav class="subjects-nav">
                        <h3>Matières</h3>
                        <div class="subject-list">
                            <a href="#" class="subject-item active" data-subject="math" id="mathSubject">
                                <i class="ri-calculator-line"></i>
                                <span>Mathématiques</span>
                            </a>
                            <a href="#" class="subject-item" data-subject="physics" id="physicsSubject">
                                <i class="ri-flask-line"></i>
                                <span>Physique</span>
                            </a>
                            <a href="#" class="subject-item" data-subject="chemistry" id="chemistrySubject">
                                <i class="ri-test-tube-line"></i>
                                <span>Chimie</span>
                            </a>
                            <a href="#" class="subject-item" data-subject="biology" id="biologySubject">
                                <i class="ri-seedling-line"></i>
                                <span>Biologie</span>
                            </a>
                            <a href="#" class="subject-item" data-subject="french" id="frenchSubject">
                                <i class="ri-book-2-line"></i>
                                <span>Français</span>
                            </a>
                            <a href="#" class="subject-item" data-subject="history" id="historySubject">
                                <i class="ri-ancient-gate-line"></i>
                                <span>Histoire</span>
                            </a>
                            <a href="#" class="subject-item" data-subject="all" id="allSubjects">
                                <i class="ri-apps-line"></i>
                                <span>Toutes les matières</span>
                            </a>
                        </div>
                    </nav>

                    <!-- Espace pour information ou aide -->
                    <div class="sidebar-info">
                        <h3>Aide</h3>
                        <p>Sélectionnez une matière pour afficher les cours correspondants.</p>
                    </div>
                </div>
            </aside>

            <!-- Zone de contenu -->
            <div class="content-area">
                <!-- Section d'accueil -->
                <section id="home" class="content-section active">
                    <div class="welcome-banner">
                        <h1>Bienvenue sur OmniLearn</h1>
                        <p>Accédez à tous les cours du programme du collège au lycée</p>
                        <div class="banner-buttons">
                            <a href="#courses" class="btn btn-primary btn-lg">
                                <i class="ri-book-open-line"></i> Explorer les cours
                            </a>
                        </div>
                    </div>

                    <div class="features-section">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="ri-book-open-line"></i>
                            </div>
                            <h3>Cours complets</h3>
                            <p>Accédez à des cours structurés et détaillés pour tous les niveaux scolaires</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="ri-community-line"></i>
                            </div>
                            <h3>Toutes les matières</h3>
                            <p>Mathématiques, physique, chimie, biologie, français, histoire et plus encore</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="ri-file-list-3-line"></i>
                            </div>
                            <h3>Exercices d'entraînement</h3>
                            <p>Testez vos connaissances avec des exercices adaptés à chaque niveau</p>
                        </div>
                    </div>

                    <div class="content-grid">
                        <!-- Niveaux scolaires -->
                        <div class="grid-section">
                            <h2>Niveaux scolaires</h2>
                            <div class="levels-grid">
                                <div class="level-card" data-level="3ème">
                                    <h3>3ème</h3>
                                    <p>Programme complet du Brevet</p>
                                    <div class="level-subjects">
                                        <span class="subject-tag" data-subject="math">Mathématiques</span>
                                        <span class="subject-tag" data-subject="physics">Physique</span>
                                        <span class="subject-tag" data-subject="french">Français</span>
                                    </div>
                                    <a href="#courses" class="btn btn-outline btn-sm">Voir les cours</a>
                                </div>
                                <div class="level-card" data-level="2nde">
                                    <h3>Seconde</h3>
                                    <p>Programme de 2nde générale</p>
                                    <div class="level-subjects">
                                        <span class="subject-tag" data-subject="math">Mathématiques</span>
                                        <span class="subject-tag" data-subject="physics">Physique-Chimie</span>
                                        <span class="subject-tag" data-subject="biology">SVT</span>
                                    </div>
                                    <a href="#courses" class="btn btn-outline btn-sm">Voir les cours</a>
                                </div>
                                <div class="level-card" data-level="1ère">
                                    <h3>Première</h3>
                                    <p>Spécialités et tronc commun</p>
                                    <div class="level-subjects">
                                        <span class="subject-tag" data-subject="math">Mathématiques</span>
                                        <span class="subject-tag" data-subject="physics">Physique</span>
                                        <span class="subject-tag" data-subject="philosophy">Philosophie</span>
                                    </div>
                                    <a href="#courses" class="btn btn-outline btn-sm">Voir les cours</a>
                                </div>
                                <div class="level-card" data-level="Tle">
                                    <h3>Terminale</h3>
                                    <p>Préparation au Baccalauréat</p>
                                    <div class="level-subjects">
                                        <span class="subject-tag" data-subject="math">Mathématiques</span>
                                        <span class="subject-tag" data-subject="physics">Physique</span>
                                        <span class="subject-tag" data-subject="history">Histoire</span>
                                    </div>
                                    <a href="#courses" class="btn btn-outline btn-sm">Voir les cours</a>
                                </div>
                            </div>
                        </div>

                        <!-- Exercices recommandés -->
                        <div class="grid-section">
                            <h2>Exercices recommandés</h2>
                            <div class="exercises-grid">
                                <!-- Les cartes d'exercices seront ajoutées dynamiquement -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section des cours -->
                <section id="courses" class="content-section">
                    <div class="section-header">
                        <h2>Cours</h2>
                        <div class="section-actions">
                            <div class="search-bar">
                                <i class="ri-search-line"></i>
                                <input type="text" class="course-search" placeholder="Rechercher un cours...">
                            </div>
                            <div class="filter-options">
                                <!-- Filtre par matière -->
                                <select class="filter-matiere">
                                    <option value="all">Toutes les matières</option>
                                    <option value="math">Mathématiques</option>
                                    <option value="physics">Physique</option>
                                    <option value="chemistry">Chimie</option>
                                    <option value="biology">Biologie</option>
                                    <option value="french">Français</option>
                                    <option value="english">Anglais</option>
                                    <option value="history">Histoire</option>
                                    <option value="geography">Géographie</option>
                                    <option value="philosophy">Philosophie</option>
                                </select>
                                
                                <!-- Filtre par niveau scolaire -->
                                <select class="filter-niveau">
                                    <option value="all">Tous les niveaux</option>
                                    <option value="3eme">3ème</option>
                                    <option value="2ndeC">2nde C</option>
                                    <option value="2ndeA">2nde A</option>
                                    <option value="1ereC">1ère C</option>
                                    <option value="1ereD">1ère D</option>
                                    <option value="1ereA">1ère A</option>
                                    <option value="TleC">Tle C</option>
                                    <option value="TleD">Tle D</option>
                                    <option value="TleA">Tle A</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Conteneur pour la liste des cours -->
                    <div class="course-container">
                        <!-- Les cours seront chargés et regroupés par niveau ici -->
                    </div>
                    
                    <!-- Conteneur pour le contenu d'un cours -->
                    <div class="course-content" style="display: none;">
                        <!-- Le contenu du cours sélectionné sera affiché ici -->
                    </div>
                </section>

                <!-- Section Programme -->
                <section id="program" class="content-section">
                    <div class="section-header">
                        <h2>Programme Scolaire</h2>
                        <div class="section-actions">
                            <div class="search-bar">
                                <i class="ri-search-line"></i>
                                <input type="text" placeholder="Rechercher un chapitre..." class="program-search">
                            </div>
                        </div>
                    </div>

                    <div class="program-navigation">
                        <div class="program-level-tabs">
                            <a href="#" class="program-level-tab active" data-level="3eme">3ème</a>
                            <a href="#" class="program-level-tab" data-level="2nde">2nde</a>
                            <a href="#" class="program-level-tab" data-level="1ere">1ère</a>
                            <a href="#" class="program-level-tab" data-level="Terminale">Terminale</a>
                        </div>
                    </div>

                    <div id="program-content" class="program-content">
                        <!-- Le contenu du programme sera injecté ici dynamiquement -->
                    </div>
                </section>

                <!-- Section des exercices -->
                <section id="exercises" class="content-section">
                    <div class="section-header">
                        <h2>Exercices</h2>
                        <div class="section-actions">
                            <div class="search-bar">
                                <i class="ri-search-line"></i>
                                <input type="text" class="exercise-search" placeholder="Rechercher un exercice...">
                            </div>
                            <div class="filter-options">
                                <button class="btn btn-outline">
                                    <i class="ri-filter-line"></i>
                                    Filtres
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="exercise-container">
                        <!-- Les exercices seront chargés dynamiquement ici -->
                    </div>
                </section>

                <!-- Section Définitions et Propriétés -->
                <section id="definitions" class="content-section">
                    <div class="section-header">
                        <h2>Définitions et Propriétés</h2>
                        <div class="section-actions">
                            <div class="search-bar">
                                <i class="ri-search-line"></i>
                                <input type="text" placeholder="Rechercher une définition..." class="definition-search">
                            </div>
                            <div class="filter-options">
                                <select class="filter-matiere definitions-filter">
                                    <option value="all">Toutes les matières</option>
                                    <option value="math">Mathématiques</option>
                                    <option value="physics">Physique</option>
                                    <option value="chemistry">Chimie</option>
                                    <option value="biology">Biologie</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="definitions-container">
                        <div class="definitions-list">
                            <!-- Les définitions seront organisées par catégorie -->
                            <div class="definition-category" data-category="math">
                                <h3 class="category-title">Mathématiques</h3>
                                
                                <div class="definition-item">
                                    <h4 class="definition-title">Théorème de Pythagore</h4>
                                    <div class="definition-content">
                                        <p>Dans un triangle rectangle, le carré de la longueur de l'hypoténuse est égal à la somme des carrés des longueurs des deux autres côtés.</p>
                                        <div class="formula-block">
                                            <p>Si ABC est un triangle rectangle en A, alors :</p>
                                            <div class="math-formula">BC² = AB² + AC²</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="definition-item">
                                    <h4 class="definition-title">Théorème de Thalès</h4>
                                    <div class="definition-content">
                                        <p>Si une droite coupe deux droites parallèles, alors elle détermine sur ces droites des segments proportionnels.</p>
                                        <div class="formula-block">
                                            <div class="math-formula">
                                                \frac{AB}{A'B'} = \frac{AC}{A'C'}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="definition-category" data-category="physics">
                                <h3 class="category-title">Physique</h3>
                                
                                <div class="definition-item">
                                    <h4 class="definition-title">Loi d'Ohm</h4>
                                    <div class="definition-content">
                                        <p>Dans un conducteur ohmique, l'intensité du courant qui le traverse est proportionnelle à la tension à ses bornes.</p>
                                        <div class="formula-block">
                                            <div class="math-formula">U = R \times I</div>
                                            <p>où :</p>
                                            <ul>
                                                <li>U est la tension en volts (V)</li>
                                                <li>R est la résistance en ohms (Ω)</li>
                                                <li>I est l'intensité en ampères (A)</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="definitions-sidebar">
                            <div class="sidebar-section">
                                <h3>Matières</h3>
                                <ul class="category-list">
                                    <li><a href="#" data-filter="all" class="active">Toutes les matières</a></li>
                                    <li><a href="#" data-filter="math">Mathématiques</a></li>
                                    <li><a href="#" data-filter="physics">Physique</a></li>
                                    <li><a href="#" data-filter="chemistry">Chimie</a></li>
                                    <li><a href="#" data-filter="biology">Biologie</a></li>
                                </ul>
                            </div>
                            
                            <div class="sidebar-section">
                                <h3>Index alphabétique</h3>
                                <div class="alphabet-index">
                                    <a href="#" class="letter">A</a>
                                    <a href="#" class="letter">B</a>
                                    <a href="#" class="letter">C</a>
                                    <a href="#" class="letter">D</a>
                                    <a href="#" class="letter">E</a>
                                    <a href="#" class="letter">F</a>
                                    <a href="#" class="letter">G</a>
                                    <a href="#" class="letter">H</a>
                                    <a href="#" class="letter">I</a>
                                    <a href="#" class="letter">J</a>
                                    <a href="#" class="letter">K</a>
                                    <a href="#" class="letter">L</a>
                                    <a href="#" class="letter">M</a>
                                    <a href="#" class="letter">N</a>
                                    <a href="#" class="letter">O</a>
                                    <a href="#" class="letter">P</a>
                                    <a href="#" class="letter">Q</a>
                                    <a href="#" class="letter">R</a>
                                    <a href="#" class="letter">S</a>
                                    <a href="#" class="letter">T</a>
                                    <a href="#" class="letter">U</a>
                                    <a href="#" class="letter">V</a>
                                    <a href="#" class="letter">W</a>
                                    <a href="#" class="letter">X</a>
                                    <a href="#" class="letter">Y</a>
                                    <a href="#" class="letter">Z</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Section des tests -->
                <section id="tests" class="content-section">
                    <div class="section-header">
                        <h2>Tests</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary">
                                <i class="ri-add-line"></i>
                                Nouveau test
                            </button>
                        </div>
                    </div>

                    <div class="tests-grid">
                        <!-- Les tests seront chargés dynamiquement ici -->
                    </div>
                </section>

                <!-- Section du cahier de formules -->
                <section id="formula-book" class="content-section">
                    <div class="formula-book-container">
                        <!-- Le contenu sera injecté par formula-book.js -->
                    </div>
                </section>

                <!-- Section de l'assistant IA -->
                <section id="ai-assistant" class="content-section">
                    <div class="ai-assistant-container">
                        <div class="ai-assistant-header">
                            <h2><i class="ri-robot-line"></i> Assistant IA OmniLearn (KroK AI de xAI)</h2>
                            <div class="assistant-controls">
                                <button class="fullscreen-assistant" title="Plein écran"><i class="ri-fullscreen-line"></i></button>
                                <button class="close-assistant"><i class="ri-close-line"></i></button>
                            </div>
                        </div>
                        <div class="ai-chat-container">
                            <div class="recording-indicator">
                                <div class="recording-timer">
                                    <i class="ri-record-circle-fill"></i>
                                    <span class="timer-display">00:00</span>
                                    <div class="privacy-indicator">Microphone actif</div>
                                </div>
                                <div class="recording-message">
                                    <span>Enregistrement en cours...</span>
                                    <div class="waveform-visualizer">
                                        <span></span><span></span><span></span><span></span><span></span>
                                    </div>
                                </div>
                                <button class="stop-recording"><i class="ri-stop-circle-line"></i></button>
                            </div>
                            <div class="ai-chat-messages"></div>
                            <div class="ai-typing-indicator" style="display: none;">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                            <div class="ai-chat-input">
                                <textarea placeholder="Posez votre question ici..." rows="1" style="resize:none;width:100%;min-height:40px;max-height:120px;"></textarea>
                                <div class="input-buttons">
                                    <button class="voice-input" title="Message vocal"><i class="ri-mic-line"></i></button>
                                    <button class="send-message"><i class="ri-send-plane-fill"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Bouton flottant pour mobile uniquement -->
        <div class="fab mobile-only">
            <i class="ri-robot-line"></i>
        </div>
    </div>

    <!-- Scripts -->
    <script src="frontend/js/main.js"></script>
    <script type="module" src="frontend/js/courses-browser.js"></script>
    <script src="frontend/js/home.js"></script>
    <script src="frontend/js/exercises.js"></script>
    <script src="frontend/js/formula-book.js"></script>
    <script src="frontend/js/ai-assistant.js"></script>
    <script src="frontend/js/definitions.js"></script>
    <script src="frontend/js/program.js"></script>
    
    <!-- Script de réinitialisation du mode sombre -->
    <script src="frontend/js/reset_dark_mode.js"></script>
    
    <!-- Script alternatif pour le chargement des cours -->
    <script src="frontend/js/courses-loader.js"></script>
    
    <!-- Script pour changer le logo en fonction du thème -->
    <script>
        // Fonction pour mettre à jour le logo en fonction du thème
        function updateLogoBasedOnTheme() {
            const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark' || 
                               document.body.classList.contains('dark-theme');
            
            // Sélectionner toutes les images de logo
            const logoImages = document.querySelectorAll('img[src*="logo"]');
            const logoPath = isDarkMode ? 'frontend/images/logo_dark.jpeg' : 'frontend/images/logo.jpeg';
            
            // Mettre à jour les sources des images
            logoImages.forEach(img => {
                img.src = logoPath;
            });
            
            // Mettre à jour les liens favicon et apple-touch-icon
            const iconLinks = document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"], link[rel="apple-touch-icon"]');
            iconLinks.forEach(link => {
                link.href = logoPath;
            });
            
            // Mettre à jour la meta tag pour IE et Windows 10
            const metaTile = document.querySelector('meta[name="msapplication-TileImage"]');
            if (metaTile) {
                metaTile.content = logoPath;
            }
            
            console.log(`Thème ${isDarkMode ? "sombre" : "clair"} détecté, logo mis à jour vers: ${logoPath}`);
        }
        
        // Exécuter lors du chargement de la page
        document.addEventListener('DOMContentLoaded', updateLogoBasedOnTheme);
        
        // Observer les changements de thème
        const themeToggles = document.querySelectorAll('.theme-switch input[type="checkbox"]');
        themeToggles.forEach(function(toggle) {
            toggle.addEventListener('change', function() {
                // Petit délai pour laisser le thème s'appliquer
                setTimeout(updateLogoBasedOnTheme, 100);
            });
        });
        
        // Observer les changements d'attributs sur le document
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.attributeName === 'data-theme' || 
                    (mutation.attributeName === 'class' && mutation.target === document.body)) {
                    updateLogoBasedOnTheme();
                }
            });
        });
        
        // Démarrer l'observation
        observer.observe(document.documentElement, { attributes: true });
        observer.observe(document.body, { attributes: true });
    </script>
    
    <!-- Script amélioré pour l'écran de chargement -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingBar = document.getElementById('loadingBar');
            const loadingPercentage = document.getElementById('loadingPercentage');
            const loadingText = document.getElementById('loadingText');
            const loadingDetails = document.getElementById('loadingDetails');
            
            // Liste des ressources à charger
            const resources = [
                { name: "Configuration de base", weight: 5 },
                { name: "Interface utilisateur", weight: 15 },
                { name: "Cours de mathématiques", weight: 20 },
                { name: "Cours de physique", weight: 20 },
                { name: "Cours de chimie", weight: 15 },
                { name: "KroK AI", weight: 25 }
            ];
            
            let totalWeight = resources.reduce((sum, res) => sum + res.weight, 0);
            let loadedWeight = 0;
            let currentResourceIndex = 0;
            
            // Fonction pour simuler le chargement d'une ressource
            function simulateResourceLoading(index) {
                if (index >= resources.length) {
                    // Tout est chargé, masquer l'écran de chargement
                    loadingBar.style.width = '100%';
                    loadingPercentage.textContent = '100%';
                    loadingText.textContent = 'Chargement terminé';
                    loadingDetails.textContent = 'Démarrage de l\'application...';
                    
                    setTimeout(() => {
                        loadingScreen.style.opacity = '0';
                        setTimeout(() => {
                            loadingScreen.style.display = 'none';
                        }, 500);
                    }, 500);
                    return;
                }
                
                const resource = resources[index];
                loadingDetails.textContent = `Chargement: ${resource.name}...`;
                
                // Simuler le chargement progressif d'une ressource
                const steps = 10; // Nombre d'étapes pour charger chaque ressource
                const stepWeight = resource.weight / steps;
                let step = 0;
                
                const stepInterval = setInterval(() => {
                    step++;
                    loadedWeight += stepWeight;
                    
                    // Calculer le pourcentage
                    const percentage = Math.min(Math.round((loadedWeight / totalWeight) * 100), 100);
                    
                    // Mettre à jour l'interface
                    loadingBar.style.width = percentage + '%';
                    loadingPercentage.textContent = percentage + '%';
                    
                    if (step >= steps) {
                        clearInterval(stepInterval);
                        currentResourceIndex++;
                        simulateResourceLoading(currentResourceIndex);
                    }
                }, 200 + Math.random() * 300); // Temps variable pour chaque étape
            }
            
            // Démarrer la simulation de chargement
            simulateResourceLoading(0);
            
            // Sécurité: s'assurer que l'écran de chargement disparaît même si une erreur se produit
            setTimeout(() => {
                if (loadingScreen && !loadingScreen.style.display === 'none') {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 500);
                    console.log('Fermeture forcée de l\'écran de chargement après délai');
                }
            }, 15000); // Fermeture de secours après 15 secondes
        });
    </script>
    
    <!-- Correction du titre de l'assistant IA -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Corriger le titre de l'assistant IA pour s'assurer qu'il affiche bien xAI
            const assistantHeader = document.querySelector('.ai-assistant-header h2');
            if (assistantHeader) {
                assistantHeader.innerHTML = '<i class="ri-robot-line"></i> Assistant IA OmniLearn (KroK AI de xAI)';
            }
        });
    </script>
    
    <!-- Script de secours pour gérer l'écran de chargement en cas d'erreur -->
    <script>
        // S'assurer que l'écran de chargement disparaisse même si une erreur se produit
        setTimeout(() => {
            const loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen && !loadingScreen.classList.contains('hidden')) {
                loadingScreen.classList.add('hidden');
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
                console.log('Fermeture forcée de l\'écran de chargement après délai');
            }
        }, 5000); // Fermeture de secours après 5 secondes
    </script>
    
    <!-- Enregistrement du service worker pour fonctionnement hors ligne -->
    <script>
        // Vérifier si les service workers sont supportés
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('frontend/js/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker enregistré avec succès:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Échec de l\'enregistrement du Service Worker:', error);
                    });
            });
        } else {
            console.log('Les Service Workers ne sont pas pris en charge par ce navigateur.');
        }
    </script>
    
    <!-- Script de détection du mode hors ligne -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const offlineBanner = document.getElementById('offline-banner');
            const closeBanner = document.querySelector('.close-banner');
            let bannerDismissed = false;
            
            // Fonction pour gérer l'affichage de la bannière
            function updateOfflineStatus() {
                if (!navigator.onLine && !bannerDismissed) {
                    offlineBanner.style.display = 'flex';
                } else {
                    offlineBanner.style.display = 'none';
                }
            }
            
            // Vérifier l'état initial
            updateOfflineStatus();
            
            // Écouter les changements d'état
            window.addEventListener('online', updateOfflineStatus);
            window.addEventListener('offline', updateOfflineStatus);
            
            // Gérer la fermeture de la bannière
            if (closeBanner) {
                closeBanner.addEventListener('click', function() {
                    offlineBanner.style.display = 'none';
                    bannerDismissed = true;
                });
            }
            
            // Fonction pour vérifier si tous les composants sont initialisés
            function checkComponentsInitialized() {
                // Vérifier si des éléments critiques sont correctement chargés
                const courseContainer = document.querySelector('.course-container');
                if (courseContainer && !courseContainer.innerHTML.trim()) {
                    console.log('Initialisation des cours...');
                    // Appeler manuellement loadCoursesData si défini
                    if (typeof loadCoursesData === 'function') {
                        loadCoursesData();
                    }
                }
            }
            
            // Vérifier les composants avec un léger délai
            setTimeout(checkComponentsInitialized, 1000);
        });
    </script>
    
    <!-- Script pour forcer le rechargement des styles CSS -->
    <script src="frontend/js/reset_cache.js"></script>
    
    <!-- Script pour la gestion des thèmes -->
    <script src="frontend/js/theme-loader.js"></script>
</body>
</html>
